//! Opset 18 compliance tests.
//!
//! Auto-generated by gen_rust_tests.py. Edit the generator, not this file.

use super::helpers::*;

#[test]
fn bitwise_and() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "bitwiseand");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    BitwiseAnd(
        BitwiseAndNode {
            name: "bitwiseand1",
            inputs: [
                Argument {
                    name: "bitwiseand_a",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "bitwiseand_b",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "bitwiseand1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn bitwise_not() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "bitwisenot");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    BitwiseNot(
        BitwiseNotNode {
            name: "bitwisenot1",
            inputs: [
                Argument {
                    name: "bitwisenot_input",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "bitwisenot1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn bitwise_or() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "bitwiseor");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    BitwiseOr(
        BitwiseOrNode {
            name: "bitwiseor1",
            inputs: [
                Argument {
                    name: "bitwiseor_a",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "bitwiseor_b",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "bitwiseor1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn bitwise_xor() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "bitwisexor");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    BitwiseXor(
        BitwiseXorNode {
            name: "bitwisexor1",
            inputs: [
                Argument {
                    name: "bitwisexor_a",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "bitwisexor_b",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "bitwisexor1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn group_normalization() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "groupnormalization");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    GroupNormalization(
        GroupNormalizationNode {
            name: "groupnormalization1",
            inputs: [
                Argument {
                    name: "groupnormalization_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        0,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        1,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "groupnormalization1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: GroupNormConfig {
                num_groups: 2,
                epsilon: 9.999999747378752e-6,
                full_precision: true,
            },
        },
    )
    "#);
}

#[test]
fn mish() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "mish");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Mish(
        MishNode {
            name: "mish1",
            inputs: [
                Argument {
                    name: "mish_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "mish1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn pad() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "pad");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Pad(
        PadNode {
            name: "pad1",
            inputs: [
                Argument {
                    name: "pad_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        2,
                    ),
                },
                Argument {
                    name: "",
                    ty: Scalar(
                        F32,
                    ),
                    value_source: Static(
                        3,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "pad1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: PadConfig {
                pads: Static(
                    [
                        1,
                        1,
                        0,
                        0,
                    ],
                ),
                constant_value: Static(
                    0.0,
                ),
                mode: Constant,
            },
        },
    )
    "#);
}

#[test]
fn reduce_l1() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducel1");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceL1(
        ReduceL1Node {
            name: "reducel11",
            inputs: [
                Argument {
                    name: "reducel1_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        4,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducel11_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_l2() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducel2");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceL2(
        ReduceL2Node {
            name: "reducel21",
            inputs: [
                Argument {
                    name: "reducel2_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        5,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducel21_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_log_sum() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducelogsum");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceLogSum(
        ReduceLogSumNode {
            name: "reducelogsum1",
            inputs: [
                Argument {
                    name: "reducelogsum_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        6,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducelogsum1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_log_sum_exp() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducelogsumexp");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceLogSumExp(
        ReduceLogSumExpNode {
            name: "reducelogsumexp1",
            inputs: [
                Argument {
                    name: "reducelogsumexp_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        7,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducelogsumexp1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_max() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducemax");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceMax(
        ReduceMaxNode {
            name: "reducemax1",
            inputs: [
                Argument {
                    name: "reducemax_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        8,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducemax1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_mean() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducemean");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceMean(
        ReduceMeanNode {
            name: "reducemean1",
            inputs: [
                Argument {
                    name: "reducemean_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        9,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducemean1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_min() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducemin");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceMin(
        ReduceMinNode {
            name: "reducemin1",
            inputs: [
                Argument {
                    name: "reducemin_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        10,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducemin1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_prod() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reduceprod");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceProd(
        ReduceProdNode {
            name: "reduceprod1",
            inputs: [
                Argument {
                    name: "reduceprod_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        11,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reduceprod1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_sum_square() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "reducesumsquare");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceSumSquare(
        ReduceSumSquareNode {
            name: "reducesumsquare1",
            inputs: [
                Argument {
                    name: "reducesumsquare_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        12,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducesumsquare1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn resize() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "resize");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Resize(
        ResizeNode {
            name: "resize1",
            inputs: [
                Argument {
                    name: "resize_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        0,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        13,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        0,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        14,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        15,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "resize1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ResizeConfig {
                mode: Nearest,
                scales: None,
                sizes: Some(
                    Static(
                        [
                            4,
                            4,
                        ],
                    ),
                ),
                coordinate_transformation_mode: "half_pixel",
                cubic_coeff_a: -0.75,
                nearest_mode: "round_prefer_floor",
                exclude_outside: 0,
                extrapolation_value: 0.0,
                antialias: 0,
            },
        },
    )
    "#);
}

#[test]
fn scatter_elements() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "scatterelements");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ScatterElements(
        ScatterElementsNode {
            name: "scatterelements1",
            inputs: [
                Argument {
                    name: "scatterelements_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant17_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
                Argument {
                    name: "scatterelements_updates",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "scatterelements1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ScatterElementsConfig {
                axis: 0,
                reduction: None,
            },
        },
    )
    "#);
}

#[test]
fn scatter_nd() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "scatternd");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ScatterND(
        ScatterNDNode {
            name: "scatternd1",
            inputs: [
                Argument {
                    name: "scatternd_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant18_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
                Argument {
                    name: "scatternd_updates",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "scatternd1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ScatterNDConfig {
                reduction: None,
            },
        },
    )
    "#);
}

#[test]
fn split() {
    let graph = load_model("opset_18.onnx");
    let node = find_node(&graph, "split");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Split(
        SplitNode {
            name: "split1",
            inputs: [
                Argument {
                    name: "split_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        6,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        18,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "split1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "split1_out2",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: SplitConfig {
                axis: 1,
                split_size: None,
                split_sizes: Some(
                    Static(
                        [
                            3,
                            3,
                        ],
                    ),
                ),
                num_outputs: None,
            },
        },
    )
    "#);
}
