//! Opset 13 compliance tests.
//!
//! Auto-generated by gen_rust_tests.py. Edit the generator, not this file.

use super::helpers::*;

#[test]
fn abs() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "abs");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Abs(
        AbsNode {
            name: "abs1",
            inputs: [
                Argument {
                    name: "abs_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "abs1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn add() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "add");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Add(
        AddNode {
            name: "add1",
            inputs: [
                Argument {
                    name: "add_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "add_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "add1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn arg_max() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "argmax");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ArgMax(
        ArgMaxNode {
            name: "argmax1",
            inputs: [
                Argument {
                    name: "argmax_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "argmax1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 3,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ArgMaxConfig {
                axis: 1,
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn arg_min() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "argmin");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ArgMin(
        ArgMinNode {
            name: "argmin1",
            inputs: [
                Argument {
                    name: "argmin_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "argmin1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 3,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ArgMinConfig {
                axis: 1,
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn cast() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "cast");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Cast(
        CastNode {
            name: "cast1",
            inputs: [
                Argument {
                    name: "cast_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "cast1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: CastConfig {
                to: I32,
            },
        },
    )
    "#);
}

#[test]
fn ceil() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "ceil");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Ceil(
        CeilNode {
            name: "ceil1",
            inputs: [
                Argument {
                    name: "ceil_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "ceil1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn clip() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "clip");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Clip(
        ClipNode {
            name: "clip1",
            inputs: [
                Argument {
                    name: "clip_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Scalar(
                        F32,
                    ),
                    value_source: Static(
                        0,
                    ),
                },
                Argument {
                    name: "",
                    ty: Scalar(
                        F32,
                    ),
                    value_source: Static(
                        1,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "clip1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ClipConfig {
                min: Some(
                    Static(
                        0.0,
                    ),
                ),
                max: Some(
                    Static(
                        6.0,
                    ),
                ),
            },
        },
    )
    "#);
}

#[test]
fn concat() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "concat");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Concat(
        ConcatNode {
            name: "concat1",
            inputs: [
                Argument {
                    name: "concat_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "concat_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "concat1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ConcatConfig {
                axis: 0,
            },
        },
    )
    "#);
}

#[test]
fn constant() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "constant");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Constant(
        ConstantNode {
            name: "constant6",
            inputs: [
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        5,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "constant6_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
            ],
        },
    )
    "#);
}

#[test]
fn depth_to_space() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "depthtospace");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    DepthToSpace(
        DepthToSpaceNode {
            name: "depthtospace1",
            inputs: [
                Argument {
                    name: "depthtospace_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        8,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "depthtospace1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: DepthToSpaceConfig {
                mode: Dcr,
                block_size: 2,
            },
        },
    )
    "#);
}

#[test]
fn div() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "div");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Div(
        DivNode {
            name: "div1",
            inputs: [
                Argument {
                    name: "div_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "div_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "div1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

/// Dropout is eliminated during post-processing (no-op).
/// Verify the model parses without error.
#[test]
fn dropout() {
    let _graph = load_model("opset_13.onnx");
}

#[test]
fn equal() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "equal");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Equal(
        EqualNode {
            name: "equal1",
            inputs: [
                Argument {
                    name: "equal_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "equal_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "equal1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: Bool,
                            rank: 3,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn erf() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "erf");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Erf(
        ErfNode {
            name: "erf1",
            inputs: [
                Argument {
                    name: "erf_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "erf1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn exp() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "exp");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Exp(
        ExpNode {
            name: "exp1",
            inputs: [
                Argument {
                    name: "exp_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "exp1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn expand() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "expand");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Expand(
        ExpandNode {
            name: "expand1",
            inputs: [
                Argument {
                    name: "expand_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        4,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "expand1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: Static(
                [
                    2,
                    3,
                ],
            ),
        },
    )
    "#);
}

#[test]
fn flatten() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "flatten");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Flatten(
        FlattenNode {
            name: "flatten1",
            inputs: [
                Argument {
                    name: "flatten_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "flatten1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        12,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: FlattenConfig {
                axis: 1,
            },
        },
    )
    "#);
}

#[test]
fn floor() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "floor");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Floor(
        FloorNode {
            name: "floor1",
            inputs: [
                Argument {
                    name: "floor_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "floor1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn gather() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "gather");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Gather(
        GatherNode {
            name: "gather1",
            inputs: [
                Argument {
                    name: "gather_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant6_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
            ],
            outputs: [
                Argument {
                    name: "gather1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: GatherConfig {
                axis: 0,
            },
        },
    )
    "#);
}

#[test]
fn gather_elements() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "gatherelements");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    GatherElements(
        GatherElementsNode {
            name: "gatherelements1",
            inputs: [
                Argument {
                    name: "gatherelements_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant7_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
            ],
            outputs: [
                Argument {
                    name: "gatherelements1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: GatherElementsConfig {
                indices: Static(
                    [
                        0,
                        1,
                        0,
                        1,
                        0,
                        1,
                    ],
                ),
                axis: 0,
            },
        },
    )
    "#);
}

#[test]
fn gather_nd() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "gathernd");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    GatherND(
        GatherNDNode {
            name: "gathernd1",
            inputs: [
                Argument {
                    name: "gathernd_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant8_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
            ],
            outputs: [
                Argument {
                    name: "gathernd1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: GatherNDConfig {
                batch_dims: 0,
            },
        },
    )
    "#);
}

#[test]
fn gemm() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "gemm");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Gemm(
        GemmNode {
            name: "gemm1",
            inputs: [
                Argument {
                    name: "gemm_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant9_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
                Argument {
                    name: "constant10_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
            ],
            outputs: [
                Argument {
                    name: "gemm1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: GemmConfig {
                alpha: 1.0,
                beta: 1.0,
                trans_a: 0,
                trans_b: 0,
            },
        },
    )
    "#);
}

#[test]
fn greater() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "greater");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Greater(
        GreaterNode {
            name: "greater1",
            inputs: [
                Argument {
                    name: "greater_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "greater_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "greater1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: Bool,
                            rank: 3,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn hardmax() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "hardmax");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Hardmax(
        HardmaxNode {
            name: "hardmax1",
            inputs: [
                Argument {
                    name: "hardmax_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "hardmax1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: HardmaxConfig {
                axis: 2,
            },
        },
    )
    "#);
}

/// Identity is eliminated during post-processing (no-op).
/// Verify the model parses without error.
#[test]
fn identity() {
    let _graph = load_model("opset_13.onnx");
}

#[test]
fn if_op() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "if");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    If(
        IfNode {
            name: "if1",
            inputs: [
                Argument {
                    name: "if_condition",
                    ty: Scalar(
                        Bool,
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "if1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: IfConfig {
                then_branch: OnnxGraph {
                    nodes: [
                        Constant(
                            ConstantNode {
                                name: "constant31",
                                inputs: [
                                    Argument {
                                        name: "",
                                        ty: Tensor(
                                            TensorType {
                                                dtype: F32,
                                                rank: 2,
                                                static_shape: Some(
                                                    [
                                                        Some(
                                                            2,
                                                        ),
                                                        Some(
                                                            3,
                                                        ),
                                                    ],
                                                ),
                                            },
                                        ),
                                        value_source: Static(
                                            0,
                                        ),
                                    },
                                ],
                                outputs: [
                                    Argument {
                                        name: "constant31_out1",
                                        ty: Tensor(
                                            TensorType {
                                                dtype: F32,
                                                rank: 2,
                                                static_shape: Some(
                                                    [
                                                        Some(
                                                            2,
                                                        ),
                                                        Some(
                                                            3,
                                                        ),
                                                    ],
                                                ),
                                            },
                                        ),
                                        value_source: Constant,
                                    },
                                ],
                            },
                        ),
                    ],
                    inputs: [],
                    outputs: [
                        Argument {
                            name: "constant31_out1",
                            ty: Tensor(
                                TensorType {
                                    dtype: F32,
                                    rank: 2,
                                    static_shape: Some(
                                        [
                                            Some(
                                                2,
                                            ),
                                            Some(
                                                3,
                                            ),
                                        ],
                                    ),
                                },
                            ),
                            value_source: Constant,
                        },
                    ],
                    value_store: Some(
                        ValueStore {
                            tensor_store: TensorStore {
                                data: {
                                    0: TensorDataRef {
                                        shape: [
                                            2,
                                            3,
                                        ],
                                        dtype: F32,
                                        source: Embedded(
                                            b"\0\0\x80?\0\0\x80?\0\0\x80?\0\0\x80?\0\0\x80?\0\0\x80?",
                                        ),
                                    },
                                },
                                next_id: 1,
                            },
                            constant_map: {
                                "constant31_out1": 0,
                            },
                        },
                    ),
                },
                else_branch: OnnxGraph {
                    nodes: [
                        Constant(
                            ConstantNode {
                                name: "constant32",
                                inputs: [
                                    Argument {
                                        name: "",
                                        ty: Tensor(
                                            TensorType {
                                                dtype: F32,
                                                rank: 2,
                                                static_shape: Some(
                                                    [
                                                        Some(
                                                            2,
                                                        ),
                                                        Some(
                                                            3,
                                                        ),
                                                    ],
                                                ),
                                            },
                                        ),
                                        value_source: Static(
                                            0,
                                        ),
                                    },
                                ],
                                outputs: [
                                    Argument {
                                        name: "constant32_out1",
                                        ty: Tensor(
                                            TensorType {
                                                dtype: F32,
                                                rank: 2,
                                                static_shape: Some(
                                                    [
                                                        Some(
                                                            2,
                                                        ),
                                                        Some(
                                                            3,
                                                        ),
                                                    ],
                                                ),
                                            },
                                        ),
                                        value_source: Constant,
                                    },
                                ],
                            },
                        ),
                    ],
                    inputs: [],
                    outputs: [
                        Argument {
                            name: "constant32_out1",
                            ty: Tensor(
                                TensorType {
                                    dtype: F32,
                                    rank: 2,
                                    static_shape: Some(
                                        [
                                            Some(
                                                2,
                                            ),
                                            Some(
                                                3,
                                            ),
                                        ],
                                    ),
                                },
                            ),
                            value_source: Constant,
                        },
                    ],
                    value_store: Some(
                        ValueStore {
                            tensor_store: TensorStore {
                                data: {
                                    0: TensorDataRef {
                                        shape: [
                                            2,
                                            3,
                                        ],
                                        dtype: F32,
                                        source: Embedded(
                                            b"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0",
                                        ),
                                    },
                                },
                                next_id: 1,
                            },
                            constant_map: {
                                "constant32_out1": 0,
                            },
                        },
                    ),
                },
                scope_ref_names: [],
            },
        },
    )
    "#);
}

#[test]
fn is_na_n() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "isnan");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    IsNaN(
        IsNaNNode {
            name: "isnan1",
            inputs: [
                Argument {
                    name: "isnan_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "isnan1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: Bool,
                            rank: 2,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn less() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "less");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Less(
        LessNode {
            name: "less1",
            inputs: [
                Argument {
                    name: "less_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "less_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "less1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: Bool,
                            rank: 3,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn log() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "log");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Log(
        LogNode {
            name: "log1",
            inputs: [
                Argument {
                    name: "log_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "log1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn log_softmax() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "logsoftmax");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    LogSoftmax(
        LogSoftmaxNode {
            name: "logsoftmax1",
            inputs: [
                Argument {
                    name: "logsoftmax_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "logsoftmax1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: LogSoftmaxConfig {
                axis: 2,
            },
        },
    )
    "#);
}

#[test]
fn mat_mul() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "matmul");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    MatMul(
        MatMulNode {
            name: "matmul1",
            inputs: [
                Argument {
                    name: "matmul_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "matmul_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "matmul1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: None,
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn max() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "max");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Max(
        MaxNode {
            name: "max1",
            inputs: [
                Argument {
                    name: "max_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "max_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "max1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn mean() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "mean");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Mean(
        MeanNode {
            name: "mean1",
            inputs: [
                Argument {
                    name: "mean_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "mean_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "mean1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn min() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "min");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Min(
        MinNode {
            name: "min1",
            inputs: [
                Argument {
                    name: "min_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "min_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "min1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn mod_op() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "mod");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Mod(
        ModNode {
            name: "mod1",
            inputs: [
                Argument {
                    name: "mod_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "mod_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "mod1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ModConfig {
                fmod: false,
            },
        },
    )
    "#);
}

#[test]
fn mul() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "mul");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Mul(
        MulNode {
            name: "mul1",
            inputs: [
                Argument {
                    name: "mul_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "mul_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "mul1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn neg() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "neg");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Neg(
        NegNode {
            name: "neg1",
            inputs: [
                Argument {
                    name: "neg_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "neg1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn non_zero() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "nonzero");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    NonZero(
        NonZeroNode {
            name: "nonzero1",
            inputs: [
                Argument {
                    name: "nonzero_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "nonzero1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    None,
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn pad() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "pad");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Pad(
        PadNode {
            name: "pad1",
            inputs: [
                Argument {
                    name: "pad_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        10,
                    ),
                },
                Argument {
                    name: "",
                    ty: Scalar(
                        F32,
                    ),
                    value_source: Static(
                        11,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "pad1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: PadConfig {
                pads: Static(
                    [
                        1,
                        1,
                        0,
                        0,
                    ],
                ),
                constant_value: Static(
                    0.0,
                ),
                mode: Constant,
            },
        },
    )
    "#);
}

#[test]
fn pow() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "pow");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Pow(
        PowNode {
            name: "pow1",
            inputs: [
                Argument {
                    name: "pow_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "pow_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "pow1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn reciprocal() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reciprocal");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Reciprocal(
        ReciprocalNode {
            name: "reciprocal1",
            inputs: [
                Argument {
                    name: "reciprocal_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reciprocal1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn reduce_l1() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducel1");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceL1(
        ReduceL1Node {
            name: "reducel11",
            inputs: [
                Argument {
                    name: "reducel1_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducel11_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_l2() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducel2");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceL2(
        ReduceL2Node {
            name: "reducel21",
            inputs: [
                Argument {
                    name: "reducel2_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducel21_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_log_sum() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducelogsum");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceLogSum(
        ReduceLogSumNode {
            name: "reducelogsum1",
            inputs: [
                Argument {
                    name: "reducelogsum_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducelogsum1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_log_sum_exp() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducelogsumexp");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceLogSumExp(
        ReduceLogSumExpNode {
            name: "reducelogsumexp1",
            inputs: [
                Argument {
                    name: "reducelogsumexp_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducelogsumexp1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_max() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducemax");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceMax(
        ReduceMaxNode {
            name: "reducemax1",
            inputs: [
                Argument {
                    name: "reducemax_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducemax1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_mean() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducemean");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceMean(
        ReduceMeanNode {
            name: "reducemean1",
            inputs: [
                Argument {
                    name: "reducemean_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducemean1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_min() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducemin");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceMin(
        ReduceMinNode {
            name: "reducemin1",
            inputs: [
                Argument {
                    name: "reducemin_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducemin1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_prod() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reduceprod");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceProd(
        ReduceProdNode {
            name: "reduceprod1",
            inputs: [
                Argument {
                    name: "reduceprod_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reduceprod1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_sum() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducesum");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceSum(
        ReduceSumNode {
            name: "reducesum1",
            inputs: [
                Argument {
                    name: "reducesum_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        12,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reducesum1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn reduce_sum_square() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reducesumsquare");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ReduceSumSquare(
        ReduceSumSquareNode {
            name: "reducesumsquare1",
            inputs: [
                Argument {
                    name: "reducesumsquare_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "reducesumsquare1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReduceConfig {
                dims: [
                    1,
                ],
                keepdims: true,
            },
        },
    )
    "#);
}

#[test]
fn relu() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "relu");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Relu(
        ReluNode {
            name: "relu1",
            inputs: [
                Argument {
                    name: "relu_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "relu1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn reshape() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "reshape");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Reshape(
        ReshapeNode {
            name: "reshape1",
            inputs: [
                Argument {
                    name: "reshape_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        13,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "reshape1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        6,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ReshapeConfig {
                shape: Static(
                    [
                        6,
                        4,
                    ],
                ),
            },
        },
    )
    "#);
}

#[test]
fn resize() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "resize");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Resize(
        ResizeNode {
            name: "resize1",
            inputs: [
                Argument {
                    name: "resize_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        0,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        14,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        0,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        15,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        16,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "resize1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ResizeConfig {
                mode: Nearest,
                scales: None,
                sizes: Some(
                    Static(
                        [
                            4,
                            4,
                        ],
                    ),
                ),
                coordinate_transformation_mode: "half_pixel",
                cubic_coeff_a: -0.75,
                nearest_mode: "round_prefer_floor",
                exclude_outside: 0,
                extrapolation_value: 0.0,
                antialias: 0,
            },
        },
    )
    "#);
}

#[test]
fn scatter_elements() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "scatterelements");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ScatterElements(
        ScatterElementsNode {
            name: "scatterelements1",
            inputs: [
                Argument {
                    name: "scatterelements_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant18_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
                Argument {
                    name: "scatterelements_updates",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "scatterelements1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ScatterElementsConfig {
                axis: 0,
                reduction: None,
            },
        },
    )
    "#);
}

#[test]
fn scatter_nd() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "scatternd");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    ScatterND(
        ScatterNDNode {
            name: "scatternd1",
            inputs: [
                Argument {
                    name: "scatternd_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "constant19_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Constant,
                },
                Argument {
                    name: "scatternd_updates",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "scatternd1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ScatterNDConfig {
                reduction: None,
            },
        },
    )
    "#);
}

#[test]
fn shape() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "shape");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Shape(
        ShapeNode {
            name: "shape1",
            inputs: [
                Argument {
                    name: "shape_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "shape1_out1",
                    ty: Shape(
                        3,
                    ),
                    value_source: Dynamic,
                },
            ],
            config: ShapeConfig {
                start: 0,
                end: 3,
            },
        },
    )
    "#);
}

#[test]
fn sigmoid() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "sigmoid");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Sigmoid(
        SigmoidNode {
            name: "sigmoid1",
            inputs: [
                Argument {
                    name: "sigmoid_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "sigmoid1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn sign() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "sign");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Sign(
        SignNode {
            name: "sign1",
            inputs: [
                Argument {
                    name: "sign_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "sign1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn size() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "size");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Size(
        SizeNode {
            name: "size1",
            inputs: [
                Argument {
                    name: "size_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "size1_out1",
                    ty: Scalar(
                        I64,
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn slice() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "slice");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Slice(
        SliceNode {
            name: "slice1",
            inputs: [
                Argument {
                    name: "slice_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        6,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        19,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        20,
                    ),
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        21,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "slice1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        6,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: SliceConfig {
                starts: Static(
                    [
                        0,
                        1,
                    ],
                ),
                ends: Static(
                    [
                        2,
                        4,
                    ],
                ),
                axes: Some(
                    Static(
                        [
                            0,
                            1,
                        ],
                    ),
                ),
                steps: Some(
                    Static(
                        [
                            1,
                            1,
                        ],
                    ),
                ),
            },
        },
    )
    "#);
}

#[test]
fn softmax() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "softmax");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Softmax(
        SoftmaxNode {
            name: "softmax1",
            inputs: [
                Argument {
                    name: "softmax_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "softmax1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: SoftmaxConfig {
                axis: 2,
            },
        },
    )
    "#);
}

#[test]
fn space_to_depth() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "spacetodepth");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    SpaceToDepth(
        SpaceToDepthNode {
            name: "spacetodepth1",
            inputs: [
                Argument {
                    name: "spacetodepth_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "spacetodepth1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        8,
                                    ),
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: SpaceToDepthConfig {
                block_size: 2,
            },
        },
    )
    "#);
}

#[test]
fn split() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "split");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Split(
        SplitNode {
            name: "split1",
            inputs: [
                Argument {
                    name: "split_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        6,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        22,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "split1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "split1_out2",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: SplitConfig {
                axis: 1,
                split_size: None,
                split_sizes: Some(
                    Static(
                        [
                            3,
                            3,
                        ],
                    ),
                ),
                num_outputs: None,
            },
        },
    )
    "#);
}

#[test]
fn sqrt() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "sqrt");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Sqrt(
        SqrtNode {
            name: "sqrt1",
            inputs: [
                Argument {
                    name: "sqrt_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "sqrt1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn squeeze() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "squeeze");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Squeeze(
        SqueezeNode {
            name: "squeeze1",
            inputs: [
                Argument {
                    name: "squeeze_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        23,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "squeeze1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: SqueezeConfig {
                axes: Some(
                    Static(
                        [
                            0,
                            2,
                        ],
                    ),
                ),
            },
        },
    )
    "#);
}

#[test]
fn sub() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "sub");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Sub(
        SubNode {
            name: "sub1",
            inputs: [
                Argument {
                    name: "sub_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "sub_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "sub1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn sum() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "sum");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Sum(
        SumNode {
            name: "sum1",
            inputs: [
                Argument {
                    name: "sum_a",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "sum_b",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "sum1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn tanh() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "tanh");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Tanh(
        TanhNode {
            name: "tanh1",
            inputs: [
                Argument {
                    name: "tanh_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "tanh1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
        },
    )
    "#);
}

#[test]
fn tile() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "tile");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Tile(
        TileNode {
            name: "tile1",
            inputs: [
                Argument {
                    name: "tile_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        24,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "tile1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: TileConfig {
                repeats: Static(
                    [
                        2,
                        3,
                    ],
                ),
            },
        },
    )
    "#);
}

#[test]
fn transpose() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "transpose");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Transpose(
        TransposeNode {
            name: "transpose1",
            inputs: [
                Argument {
                    name: "transpose_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            outputs: [
                Argument {
                    name: "transpose1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 3,
                            static_shape: Some(
                                [
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: TransposeConfig {
                perm: [
                    2,
                    1,
                    0,
                ],
            },
        },
    )
    "#);
}

#[test]
fn unsqueeze() {
    let graph = load_model("opset_13.onnx");
    let node = find_node(&graph, "unsqueeze");
    insta::assert_snapshot!(format!("{node:#?}"), @r#"
    Unsqueeze(
        UnsqueezeNode {
            name: "unsqueeze1",
            inputs: [
                Argument {
                    name: "unsqueeze_input",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 2,
                            static_shape: Some(
                                [
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
                Argument {
                    name: "",
                    ty: Tensor(
                        TensorType {
                            dtype: I64,
                            rank: 1,
                            static_shape: Some(
                                [
                                    Some(
                                        2,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Static(
                        25,
                    ),
                },
            ],
            outputs: [
                Argument {
                    name: "unsqueeze1_out1",
                    ty: Tensor(
                        TensorType {
                            dtype: F32,
                            rank: 4,
                            static_shape: Some(
                                [
                                    Some(
                                        1,
                                    ),
                                    Some(
                                        3,
                                    ),
                                    Some(
                                        4,
                                    ),
                                    Some(
                                        1,
                                    ),
                                ],
                            ),
                        },
                    ),
                    value_source: Dynamic,
                },
            ],
            config: Static(
                [
                    0,
                    3,
                ],
            ),
        },
    )
    "#);
}
